{
  "data": {
    "type": "provider-docs",
    "id": "3198044",
    "attributes": {
      "category": "resources",
      "content": "---\nsubcategory: \"CE (Cost Explorer)\"\nlayout: \"aws\"\npage_title: \"AWS: aws_ce_anomaly_subscription\"\ndescription: |-\n  Provides a CE Cost Anomaly Subscription\n---\n\n# Resource: aws_ce_anomaly_subscription\n\nProvides a CE Anomaly Subscription.\n\n## Example Usage\n\n### Basic Example\n\n```terraform\nresource \"aws_ce_anomaly_monitor\" \"test\" {\n  name              = \"AWSServiceMonitor\"\n  monitor_type      = \"DIMENSIONAL\"\n  monitor_dimension = \"SERVICE\"\n}\n\nresource \"aws_ce_anomaly_subscription\" \"test\" {\n  name      = \"DAILYSUBSCRIPTION\"\n  threshold = 100\n  frequency = \"DAILY\"\n\n  monitor_arn_list = [\n    aws_ce_anomaly_monitor.test.arn,\n  ]\n\n  subscriber {\n    type    = \"EMAIL\"\n    address = \"abc@example.com\"\n  }\n}\n```\n\n### Threshold Expression Example\n\n#### For a Specific Dimension\n\n```terraform\nresource \"aws_ce_anomaly_subscription\" \"test\" {\n  name      = \"AWSServiceMonitor\"\n  frequency = \"DAILY\"\n\n  monitor_arn_list = [\n    aws_ce_anomaly_monitor.test.arn,\n  ]\n\n  subscriber {\n    type    = \"EMAIL\"\n    address = \"abc@example.com\"\n  }\n\n  threshold_expression {\n    dimension {\n      key           = \"ANOMALY_TOTAL_IMPACT_ABSOLUTE\"\n      values        = [\"100.0\"]\n      match_options = [\"GREATER_THAN_OR_EQUAL\"]\n    }\n  }\n}\n```\n\n#### Using an `and` Expression\n\n```terraform\nresource \"aws_ce_anomaly_subscription\" \"test\" {\n  name      = \"AWSServiceMonitor\"\n  frequency = \"DAILY\"\n\n  monitor_arn_list = [\n    aws_ce_anomaly_monitor.test.arn,\n  ]\n\n  subscriber {\n    type    = \"EMAIL\"\n    address = \"abc@example.com\"\n  }\n\n  threshold_expression {\n    and {\n      dimension {\n        key           = \"ANOMALY_TOTAL_IMPACT_ABSOLUTE\"\n        match_options = [\"GREATER_THAN_OR_EQUAL\"]\n        values        = [\"100\"]\n      }\n    }\n    and {\n      dimension {\n        key           = \"ANOMALY_TOTAL_IMPACT_PERCENTAGE\"\n        match_options = [\"GREATER_THAN_OR_EQUAL\"]\n        values        = [\"50\"]\n      }\n    }\n  }\n}\n```\n\n### SNS Example\n\n```terraform\nresource \"aws_sns_topic\" \"cost_anomaly_updates\" {\n  name = \"CostAnomalyUpdates\"\n}\n\ndata \"aws_iam_policy_document\" \"sns_topic_policy\" {\n  policy_id = \"__default_policy_ID\"\n\n  statement {\n    sid = \"AWSAnomalyDetectionSNSPublishingPermissions\"\n\n    actions = [\n      \"SNS:Publish\",\n    ]\n\n    effect = \"Allow\"\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"costalerts.amazonaws.com\"]\n    }\n\n    resources = [\n      aws_sns_topic.cost_anomaly_updates.arn,\n    ]\n  }\n\n  statement {\n    sid = \"__default_statement_ID\"\n\n    actions = [\n      \"SNS:Subscribe\",\n      \"SNS:SetTopicAttributes\",\n      \"SNS:RemovePermission\",\n      \"SNS:Receive\",\n      \"SNS:Publish\",\n      \"SNS:ListSubscriptionsByTopic\",\n      \"SNS:GetTopicAttributes\",\n      \"SNS:DeleteTopic\",\n      \"SNS:AddPermission\",\n    ]\n\n    condition {\n      test     = \"StringEquals\"\n      variable = \"AWS:SourceOwner\"\n\n      values = [\n        var.account-id,\n      ]\n    }\n\n    effect = \"Allow\"\n\n    principals {\n      type        = \"AWS\"\n      identifiers = [\"*\"]\n    }\n\n    resources = [\n      aws_sns_topic.cost_anomaly_updates.arn,\n    ]\n  }\n}\n\nresource \"aws_sns_topic_policy\" \"default\" {\n  arn = aws_sns_topic.cost_anomaly_updates.arn\n\n  policy = data.aws_iam_policy_document.sns_topic_policy.json\n}\n\nresource \"aws_ce_anomaly_monitor\" \"anomaly_monitor\" {\n  name              = \"AWSServiceMonitor\"\n  monitor_type      = \"DIMENSIONAL\"\n  monitor_dimension = \"SERVICE\"\n}\n\nresource \"aws_ce_anomaly_subscription\" \"realtime_subscription\" {\n  name      = \"RealtimeAnomalySubscription\"\n  threshold = 0\n  frequency = \"IMMEDIATE\"\n\n  monitor_arn_list = [\n    aws_ce_anomaly_monitor.anomaly_monitor.arn,\n  ]\n\n  subscriber {\n    type    = \"SNS\"\n    address = aws_sns_topic.cost_anomaly_updates.arn\n  }\n\n  depends_on = [\n    aws_sns_topic_policy.default,\n  ]\n}\n```\n\n## Argument Reference\n\nThe following arguments are required:\n\n* `account_id` - (Optional) The unique identifier for the AWS account in which the anomaly subscription ought to be created.\n* `frequency` - (Required) The frequency that anomaly reports are sent. Valid Values: `DAILY` | `IMMEDIATE` | `WEEKLY`.\n* `monitor_arn_list` - (Required) A list of cost anomaly monitors.\n* `name` - (Required) The name for the subscription.\n* `subscriber` - (Required) A subscriber configuration. Multiple subscribers can be defined.\n    * `type` - (Required) The type of subscription. Valid Values: `SNS` | `EMAIL`.\n    * `address` - (Required) The address of the subscriber. If type is `SNS`, this will be the arn of the sns topic. If type is `EMAIL`, this will be the destination email address.\n* `threshold` - (Optional) The dollar value that triggers a notification if the threshold is exceeded. Depracated, use `threshold_expression` instead.\n* `threshold_expression` - (Optional) An Expression object used to specify the anomalies that you want to generate alerts for. See [Threshold Expression](#threshold-expression).\n* `tags` - (Optional) A map of tags to assign to the resource. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.\n\n### Threshold Expression\n\n* `and` - (Optional) Return results that match both [Dimension](#dimension) objects.\n* `cost_category` - (Optional) Configuration block for the filter that's based on  values. See [Cost Category](#cost-category) below.\n* `dimension` - (Optional) Configuration block for the specific [Dimension](#dimension) to use for.\n* `not` - (Optional) Return results that match both [Dimension](#dimension) object.\n* `or` - (Optional) Return results that match both [Dimension](#dimension) object.\n* `tags` - (Optional) Configuration block for the specific Tag to use for. See [Tags](#tags) below.\n\n### Cost Category\n\n* `key` - (Optional) Unique name of the Cost Category.\n* `match_options` - (Optional) Match options that you can use to filter your results. MatchOptions is only applicable for actions related to cost category. The default values for MatchOptions is `EQUALS` and `CASE_SENSITIVE`. Valid values are: `EQUALS`,  `ABSENT`, `STARTS_WITH`, `ENDS_WITH`, `CONTAINS`, `CASE_SENSITIVE`, `CASE_INSENSITIVE`.\n* `values` - (Optional) Specific value of the Cost Category.\n\n### Dimension\n\n* `key` - (Optional) Unique name of the Cost Category.\n* `match_options` - (Optional) Match options that you can use to filter your results. MatchOptions is only applicable for actions related to cost category. The default values for MatchOptions is `EQUALS` and `CASE_SENSITIVE`. Valid values are: `EQUALS`,  `ABSENT`, `STARTS_WITH`, `ENDS_WITH`, `CONTAINS`, `CASE_SENSITIVE`, `CASE_INSENSITIVE`.\n* `values` - (Optional) Specific value of the Cost Category.\n\n### Tags\n\n* `key` - (Optional) Key for the tag.\n* `match_options` - (Optional) Match options that you can use to filter your results. MatchOptions is only applicable for actions related to cost category. The default values for MatchOptions is `EQUALS` and `CASE_SENSITIVE`. Valid values are: `EQUALS`,  `ABSENT`, `STARTS_WITH`, `ENDS_WITH`, `CONTAINS`, `CASE_SENSITIVE`, `CASE_INSENSITIVE`.\n* `values` - (Optional) Specific value of the Cost Category.\n\n## Attribute Reference\n\nThis resource exports the following attributes in addition to the arguments above:\n\n* `arn` - ARN of the anomaly subscription.\n* `id` - Unique ID of the anomaly subscription. Same as `arn`.\n* `tags_all` - A map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).\n\n## Import\n\nIn Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import `aws_ce_anomaly_subscription` using the `id`. For example:\n\n```terraform\nimport {\n  to = aws_ce_anomaly_subscription.example\n  id = \"AnomalySubscriptionARN\"\n}\n```\n\nUsing `terraform import`, import `aws_ce_anomaly_subscription` using the `id`. For example:\n\n```console\n% terraform import aws_ce_anomaly_subscription.example AnomalySubscriptionARN\n```\n",
      "language": "hcl",
      "path": "website/docs/r/ce_anomaly_subscription.html.markdown",
      "slug": "ce_anomaly_subscription",
      "subcategory": "CE (Cost Explorer)",
      "title": "ce_anomaly_subscription",
      "truncated": false
    },
    "links": {
      "self": "/v2/provider-docs/3198044"
    }
  }
}