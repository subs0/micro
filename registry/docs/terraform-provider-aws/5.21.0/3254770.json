{
  "data": {
    "type": "provider-docs",
    "id": "3254770",
    "attributes": {
      "category": "resources",
      "content": "---\nsubcategory: \"API Gateway\"\nlayout: \"aws\"\npage_title: \"AWS: aws_api_gateway_method_settings\"\ndescription: |-\n  Manages API Gateway Stage Method Settings\n---\n\n# Resource: aws_api_gateway_method_settings\n\nManages API Gateway Stage Method Settings. For example, CloudWatch logging and metrics.\n\n~> **NOTE:** We recommend using this resource in conjunction with the [`aws_api_gateway_stage` resource](api_gateway_stage.html) instead of a stage managed by the [`aws_api_gateway_deployment` resource](api_gateway_deployment.html) optional `stage_name` argument. Stages managed by the `aws_api_gateway_deployment` resource are recreated on redeployment and this resource will require a second apply to recreate the method settings.\n\n## Example Usage\n\n### End-to-end\n\nAn end-to-end example of a REST API configured with OpenAPI can be found in the [`/examples/api-gateway-rest-api-openapi` directory within the GitHub repository](https://github.com/hashicorp/terraform-provider-aws/tree/main/examples/api-gateway-rest-api-openapi).\n\n### Basic Usage\n\n```terraform\nresource \"aws_api_gateway_rest_api\" \"example\" {\n  body = jsonencode({\n    openapi = \"3.0.1\"\n    info = {\n      title   = \"example\"\n      version = \"1.0\"\n    }\n    paths = {\n      \"/path1\" = {\n        get = {\n          x-amazon-apigateway-integration = {\n            httpMethod           = \"GET\"\n            payloadFormatVersion = \"1.0\"\n            type                 = \"HTTP_PROXY\"\n            uri                  = \"https://ip-ranges.amazonaws.com/ip-ranges.json\"\n          }\n        }\n      }\n    }\n  })\n\n  name = \"example\"\n}\n\nresource \"aws_api_gateway_deployment\" \"example\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n\n  triggers = {\n    redeployment = sha1(jsonencode(aws_api_gateway_rest_api.example.body))\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\nresource \"aws_api_gateway_stage\" \"example\" {\n  deployment_id = aws_api_gateway_deployment.example.id\n  rest_api_id   = aws_api_gateway_rest_api.example.id\n  stage_name    = \"example\"\n}\n\nresource \"aws_api_gateway_method_settings\" \"all\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"*/*\"\n\n  settings {\n    metrics_enabled = true\n    logging_level   = \"ERROR\"\n  }\n}\n\nresource \"aws_api_gateway_method_settings\" \"path_specific\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    metrics_enabled = true\n    logging_level   = \"INFO\"\n  }\n}\n```\n\n### CloudWatch Logging and Tracing\n\nThe AWS Console API Gateway Editor displays multiple options for CloudWatch Logs that don't directly map to the options in the AWS API and Terraform. These examples show the `settings` blocks that are equivalent to the options the AWS Console gives for CloudWatch Logs.\n\n#### Off\n\n```terraform\nresource \"aws_api_gateway_method_settings\" \"path_specific\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    logging_level = \"OFF\"\n  }\n}\n```\n\n#### Errors Only\n\n```terraform\nresource \"aws_api_gateway_method_settings\" \"path_specific\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    logging_level      = \"ERROR\"\n    metrics_enabled    = true\n    data_trace_enabled = false\n  }\n}\n```\n\n#### Errors and Info Logs\n\n```terraform\nresource \"aws_api_gateway_method_settings\" \"path_specific\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    logging_level      = \"INFO\"\n    metrics_enabled    = true\n    data_trace_enabled = false\n  }\n}\n```\n\n#### Full Request and Response Logs\n\n```terraform\nresource \"aws_api_gateway_method_settings\" \"path_specific\" {\n  rest_api_id = aws_api_gateway_rest_api.example.id\n  stage_name  = aws_api_gateway_stage.example.stage_name\n  method_path = \"path1/GET\"\n\n  settings {\n    logging_level      = \"INFO\"\n    metrics_enabled    = true\n    data_trace_enabled = true\n  }\n}\n```\n\n## Argument Reference\n\nThis resource supports the following arguments:\n\n* `rest_api_id` - (Required) ID of the REST API\n* `stage_name` - (Required) Name of the stage\n* `method_path` - (Required) Method path defined as `{resource_path}/{http_method}` for an individual method override, or `*/*` for overriding all methods in the stage. Ensure to trim any leading forward slashes in the path (e.g., `trimprefix(aws_api_gateway_resource.example.path, \"/\")`).\n* `settings` - (Required) Settings block, see below.\n\n### `settings`\n\n* `metrics_enabled` - (Optional) Whether Amazon CloudWatch metrics are enabled for this method.\n* `logging_level` - (Optional) Logging level for this method, which effects the log entries pushed to Amazon CloudWatch Logs. The available levels are `OFF`, `ERROR`, and `INFO`.\n* `data_trace_enabled` - (Optional) Whether data trace logging is enabled for this method, which effects the log entries pushed to Amazon CloudWatch Logs.\n* `throttling_burst_limit` - (Optional) Throttling burst limit. Default: `-1` (throttling disabled).\n* `throttling_rate_limit` - (Optional) Throttling rate limit. Default: `-1` (throttling disabled).\n* `caching_enabled` - (Optional) Whether responses should be cached and returned for requests. A cache cluster must be enabled on the stage for responses to be cached.\n* `cache_ttl_in_seconds` - (Optional) Time to live (TTL), in seconds, for cached responses. The higher the TTL, the longer the response will be cached.\n* `cache_data_encrypted` - (Optional) Whether the cached responses are encrypted.\n* `require_authorization_for_cache_control` - (Optional) Whether authorization is required for a cache invalidation request.\n* `unauthorized_cache_control_header_strategy` - (Optional) How to handle unauthorized requests for cache invalidation. The available values are `FAIL_WITH_403`, `SUCCEED_WITH_RESPONSE_HEADER`, `SUCCEED_WITHOUT_RESPONSE_HEADER`.\n\n## Attribute Reference\n\nThis resource exports no additional attributes.\n\n## Import\n\nIn Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import `aws_api_gateway_method_settings` using `REST-API-ID/STAGE-NAME/METHOD-PATH`. For example:\n\n```terraform\nimport {\n  to = aws_api_gateway_method_settings.example\n  id = \"12345abcde/example/test/GET\"\n}\n```\n\nUsing `terraform import`, import `aws_api_gateway_method_settings` using `REST-API-ID/STAGE-NAME/METHOD-PATH`. For example:\n\n```console\n% terraform import aws_api_gateway_method_settings.example 12345abcde/example/test/GET\n```\n",
      "language": "hcl",
      "path": "website/docs/r/api_gateway_method_settings.html.markdown",
      "slug": "api_gateway_method_settings",
      "subcategory": "API Gateway",
      "title": "api_gateway_method_settings",
      "truncated": false
    },
    "links": {
      "self": "/v2/provider-docs/3254770"
    }
  }
}