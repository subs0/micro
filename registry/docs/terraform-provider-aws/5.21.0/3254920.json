{
  "data": {
    "type": "provider-docs",
    "id": "3254920",
    "attributes": {
      "category": "resources",
      "content": "---\nsubcategory: \"CloudTrail\"\nlayout: \"aws\"\npage_title: \"AWS: aws_cloudtrail_event_data_store\"\ndescription: |-\n  Provides a CloudTrail Event Data Store resource.\n---\n\n# Resource: aws_cloudtrail_event_data_store\n\nProvides a CloudTrail Event Data Store.\n\nMore information about event data stores can be found in the [Event Data Store User Guide](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-event-data-store.html).\n\n-> **Tip:** For an organization event data store you must create this resource in the management account.\n\n## Example Usage\n\n### Basic\n\nThe most simple event data store configuration requires us to only set the `name` attribute. The event data store will automatically capture all management events. To capture management events from all the regions, `multi_region_enabled` must be `true`.\n\n```terraform\nresource \"aws_cloudtrail_event_data_store\" \"example\" {\n  name = \"example-event-data-store\"\n}\n```\n\n### Data Event Logging\n\nCloudTrail can log [Data Events](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html) for certain services such as S3 bucket objects and Lambda function invocations. Additional information about data event configuration can be found in the following links:\n\n- [CloudTrail API AdvancedFieldSelector documentation](https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_AdvancedFieldSelector.html)\n\n#### Log all DynamoDB PutEvent actions for a specific DynamoDB table\n\n```terraform\ndata \"aws_dynamodb_table\" \"table\" {\n  name = \"not-important-dynamodb-table\"\n}\n\nresource \"aws_cloudtrail_event_data_store\" \"example\" {\n  # ... other configuration ...\n\n  advanced_event_selector {\n    name = \"Log all DynamoDB PutEvent actions for a specific DynamoDB table\"\n\n    field_selector {\n      field  = \"eventCategory\"\n      equals = [\"Data\"]\n    }\n\n    field_selector {\n      field = \"resources.type\"\n\n      equals = [\n        \"AWS::DynamoDB::Table\"\n      ]\n    }\n\n    field_selector {\n      field  = \"eventName\"\n      equals = [\"PutItem\"]\n    }\n\n    field_selector {\n      field = \"resources.ARN\"\n\n      equals = [\n        data.aws_dynamodb_table.table.arn\n      ]\n    }\n  }\n}\n```\n\n## Argument Reference\n\nThis resource supports the following arguments:\n\n- `name` - (Required) The name of the event data store.\n- `advanced_event_selector` - (Optional) The advanced event selectors to use to select the events for the data store. For more information about how to use advanced event selectors, see [Log events by using advanced event selectors](https://docs.aws.amazon.com/awscloudtrail/latest/userguide/logging-data-events-with-cloudtrail.html#creating-data-event-selectors-advanced) in the CloudTrail User Guide.\n- `multi_region_enabled` - (Optional) Specifies whether the event data store includes events from all regions, or only from the region in which the event data store is created. Default: `true`.\n- `organization_enabled` - (Optional) Specifies whether an event data store collects events logged for an organization in AWS Organizations. Default: `false`.\n- `retention_period` - (Optional) The retention period of the event data store, in days. You can set a retention period of up to 2555 days, the equivalent of seven years. Default: `2555`.\n- `kms_key_id` - Specifies the AWS KMS key ID to use to encrypt the events delivered by CloudTrail. The value can be an alias name prefixed by alias/, a fully specified ARN to an alias, a fully specified ARN to a key, or a globally unique identifier.\n- `tags` - (Optional) A map of tags to assign to the resource. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.\n- `termination_protection_enabled` - (Optional) Specifies whether termination protection is enabled for the event data store. If termination protection is enabled, you cannot delete the event data store until termination protection is disabled. Default: `true`.\n\n### Advanced Event Selector Arguments\n\n`advanced_event_selector` supports the following arguments:\n\n- `name` (Optional) - Specifies the name of the advanced event selector.\n- `field_selector` (Required) - Specifies the selector statements in an advanced event selector. Fields documented below.\n\n#### Field Selector Arguments\n\n`field_selector` supports the following arguments:\n\n- `field` (Required) - Specifies a field in an event record on which to filter events to be logged. You can specify only the following values: `readOnly`, `eventSource`, `eventName`, `eventCategory`, `resources.type`, `resources.ARN`.\n- `equals` (Optional) - A list of values that includes events that match the exact value of the event record field specified as the value of `field`. This is the only valid operator that you can use with the `readOnly`, `eventCategory`, and `resources.type` fields.\n- `not_equals` (Optional) - A list of values that excludes events that match the exact value of the event record field specified as the value of `field`.\n- `starts_with` (Optional) - A list of values that includes events that match the first few characters of the event record field specified as the value of `field`.\n- `not_starts_with` (Optional) - A list of values that excludes events that match the first few characters of the event record field specified as the value of `field`.\n- `ends_with` (Optional) - A list of values that includes events that match the last few characters of the event record field specified as the value of `field`.\n- `not_ends_with` (Optional) - A list of values that excludes events that match the last few characters of the event record field specified as the value of `field`.\n\n## Attribute Reference\n\nThis resource exports the following attributes in addition to the arguments above:\n\n- `arn` - ARN of the event data store.\n- `id` - Name of the event data store.\n- `tags_all` - Map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).\n\n## Import\n\nIn Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import event data stores using their `arn`. For example:\n\n```terraform\nimport {\n  to = aws_cloudtrail_event_data_store.example\n  id = \"arn:aws:cloudtrail:us-east-1:123456789123:eventdatastore/22333815-4414-412c-b155-dd254033gfhf\"\n}\n```\n\nUsing `terraform import`, import event data stores using their `arn`. For example:\n\n```console\n% terraform import aws_cloudtrail_event_data_store.example arn:aws:cloudtrail:us-east-1:123456789123:eventdatastore/22333815-4414-412c-b155-dd254033gfhf\n```\n",
      "language": "hcl",
      "path": "website/docs/r/cloudtrail_event_data_store.html.markdown",
      "slug": "cloudtrail_event_data_store",
      "subcategory": "CloudTrail",
      "title": "cloudtrail_event_data_store",
      "truncated": false
    },
    "links": {
      "self": "/v2/provider-docs/3254920"
    }
  }
}