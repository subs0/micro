{
  "data": {
    "type": "provider-docs",
    "id": "3255879",
    "attributes": {
      "category": "resources",
      "content": "---\nsubcategory: \"Storage Gateway\"\nlayout: \"aws\"\npage_title: \"AWS: aws_storagegateway_gateway\"\ndescription: |-\n  Manages an AWS Storage Gateway file, tape, or volume gateway in the provider region\n---\n\n# Resource: aws_storagegateway_gateway\n\nManages an AWS Storage Gateway file, tape, or volume gateway in the provider region.\n\n~> **NOTE:** The Storage Gateway API requires the gateway to be connected to properly return information after activation. If you are receiving `The specified gateway is not connected` errors during resource creation (gateway activation), ensure your gateway instance meets the [Storage Gateway requirements](https://docs.aws.amazon.com/storagegateway/latest/userguide/Requirements.html).\n\n## Example Usage\n\n### Local Cache\n\n```terraform\nresource \"aws_volume_attachment\" \"test\" {\n  device_name = \"/dev/xvdb\"\n  volume_id   = aws_ebs_volume.test.id\n  instance_id = aws_instance.test.id\n}\n\ndata \"aws_storagegateway_local_disk\" \"test\" {\n  disk_node   = data.aws_volume_attachment.test.device_name\n  gateway_arn = aws_storagegateway_gateway.test.arn\n}\n\nresource \"aws_storagegateway_cache\" \"test\" {\n  disk_id     = data.aws_storagegateway_local_disk.test.disk_id\n  gateway_arn = aws_storagegateway_gateway.test.arn\n}\n```\n\n### FSx File Gateway\n\n```terraform\nresource \"aws_storagegateway_gateway\" \"example\" {\n  gateway_ip_address = \"1.2.3.4\"\n  gateway_name       = \"example\"\n  gateway_timezone   = \"GMT\"\n  gateway_type       = \"FILE_FSX_SMB\"\n  smb_active_directory_settings {\n    domain_name = \"corp.example.com\"\n    password    = \"avoid-plaintext-passwords\"\n    username    = \"Admin\"\n  }\n}\n```\n\n### S3 File Gateway\n\n```terraform\nresource \"aws_storagegateway_gateway\" \"example\" {\n  gateway_ip_address = \"1.2.3.4\"\n  gateway_name       = \"example\"\n  gateway_timezone   = \"GMT\"\n  gateway_type       = \"FILE_S3\"\n}\n```\n\n### Tape Gateway\n\n```terraform\nresource \"aws_storagegateway_gateway\" \"example\" {\n  gateway_ip_address  = \"1.2.3.4\"\n  gateway_name        = \"example\"\n  gateway_timezone    = \"GMT\"\n  gateway_type        = \"VTL\"\n  medium_changer_type = \"AWS-Gateway-VTL\"\n  tape_drive_type     = \"IBM-ULT3580-TD5\"\n}\n```\n\n### Volume Gateway (Cached)\n\n```terraform\nresource \"aws_storagegateway_gateway\" \"example\" {\n  gateway_ip_address = \"1.2.3.4\"\n  gateway_name       = \"example\"\n  gateway_timezone   = \"GMT\"\n  gateway_type       = \"CACHED\"\n}\n```\n\n### Volume Gateway (Stored)\n\n```terraform\nresource \"aws_storagegateway_gateway\" \"example\" {\n  gateway_ip_address = \"1.2.3.4\"\n  gateway_name       = \"example\"\n  gateway_timezone   = \"GMT\"\n  gateway_type       = \"STORED\"\n}\n```\n\n## Argument Reference\n\n~> **NOTE:** One of `activation_key` or `gateway_ip_address` must be provided for resource creation (gateway activation). Neither is required for resource import. If using `gateway_ip_address`, Terraform must be able to make an HTTP (port 80) GET request to the specified IP address from where it is running.\n\nThis argument supports the following arguments:\n\n* `gateway_name` - (Required) Name of the gateway.\n* `gateway_timezone` - (Required) Time zone for the gateway. The time zone is of the format \"GMT\", \"GMT-hr:mm\", or \"GMT+hr:mm\". For example, `GMT-4:00` indicates the time is 4 hours behind GMT. The time zone is used, for example, for scheduling snapshots and your gateway's maintenance schedule.\n* `activation_key` - (Optional) Gateway activation key during resource creation. Conflicts with `gateway_ip_address`. Additional information is available in the [Storage Gateway User Guide](https://docs.aws.amazon.com/storagegateway/latest/userguide/get-activation-key.html).\n* `average_download_rate_limit_in_bits_per_sec` - (Optional) The average download bandwidth rate limit in bits per second. This is supported for the `CACHED`, `STORED`, and `VTL` gateway types.\n* `average_upload_rate_limit_in_bits_per_sec` - (Optional) The average upload bandwidth rate limit in bits per second. This is supported for the `CACHED`, `STORED`, and `VTL` gateway types.\n* `gateway_ip_address` - (Optional) Gateway IP address to retrieve activation key during resource creation. Conflicts with `activation_key`. Gateway must be accessible on port 80 from where Terraform is running. Additional information is available in the [Storage Gateway User Guide](https://docs.aws.amazon.com/storagegateway/latest/userguide/get-activation-key.html).\n* `gateway_type` - (Optional) Type of the gateway. The default value is `STORED`. Valid values: `CACHED`, `FILE_FSX_SMB`, `FILE_S3`, `STORED`, `VTL`.\n* `gateway_vpc_endpoint` - (Optional) VPC endpoint address to be used when activating your gateway. This should be used when your instance is in a private subnet. Requires HTTP access from client computer running terraform. More info on what ports are required by your VPC Endpoint Security group in [Activating a Gateway in a Virtual Private Cloud](https://docs.aws.amazon.com/storagegateway/latest/userguide/gateway-private-link.html).\n* `cloudwatch_log_group_arn` - (Optional) The Amazon Resource Name (ARN) of the Amazon CloudWatch log group to use to monitor and log events in the gateway.\n* `maintenance_start_time` - (Optional) The gateway's weekly maintenance start time information, including day and time of the week. The maintenance time is the time in your gateway's time zone. More details below.\n* `medium_changer_type` - (Optional) Type of medium changer to use for tape gateway. Terraform cannot detect drift of this argument. Valid values: `STK-L700`, `AWS-Gateway-VTL`, `IBM-03584L32-0402`.\n* `smb_active_directory_settings` - (Optional) Nested argument with Active Directory domain join information for Server Message Block (SMB) file shares. Only valid for `FILE_S3` and `FILE_FSX_SMB` gateway types. Must be set before creating `ActiveDirectory` authentication SMB file shares. More details below.\n* `smb_guest_password` - (Optional) Guest password for Server Message Block (SMB) file shares. Only valid for `FILE_S3` and `FILE_FSX_SMB` gateway types. Must be set before creating `GuestAccess` authentication SMB file shares. Terraform can only detect drift of the existence of a guest password, not its actual value from the gateway. Terraform can however update the password with changing the argument.\n* `smb_security_strategy` - (Optional) Specifies the type of security strategy. Valid values are: `ClientSpecified`, `MandatorySigning`, and `MandatoryEncryption`. See [Setting a Security Level for Your Gateway](https://docs.aws.amazon.com/storagegateway/latest/userguide/managing-gateway-file.html#security-strategy) for more information.\n* `smb_file_share_visibility` - (Optional) Specifies whether the shares on this gateway appear when listing shares.\n* `tape_drive_type` - (Optional) Type of tape drive to use for tape gateway. Terraform cannot detect drift of this argument. Valid values: `IBM-ULT3580-TD5`.\n* `tags` - (Optional) Key-value map of resource tags. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.\n\n### maintenance_start_time\n\n* `day_of_month` - (Optional) The day of the month component of the maintenance start time represented as an ordinal number from 1 to 28, where 1 represents the first day of the month and 28 represents the last day of the month.\n* `day_of_week` - (Optional) The day of the week component of the maintenance start time week represented as an ordinal number from 0 to 6, where 0 represents Sunday and 6 Saturday.\n* `hour_of_day` - (Required) The hour component of the maintenance start time represented as _hh_, where _hh_ is the hour (00 to 23). The hour of the day is in the time zone of the gateway.\n* `minute_of_hour` - (Required) The minute component of the maintenance start time represented as _mm_, where _mm_ is the minute (00 to 59). The minute of the hour is in the time zone of the gateway.\n\n### smb_active_directory_settings\n\nInformation to join the gateway to an Active Directory domain for Server Message Block (SMB) file shares.\n\n~> **NOTE** It is not possible to unconfigure this setting without recreating the gateway. Also, Terraform can only detect drift of the `domain_name` argument from the gateway.\n\n~> **NOTE:** The Storage Gateway needs to be able to resolve the name of your Active Directory Domain Controller. If the gateway is hosted on EC2, ensure that DNS/DHCP is configured prior to creating the EC2 instance. If you are receiving `NETWORK_ERROR` errors during resource creation (gateway joining the domain), ensure your gateway instance meets the [FSx File Gateway requirements](https://docs.aws.amazon.com/filegateway/latest/filefsxw/Requirements.html).\n\n* `domain_name` - (Required) The name of the domain that you want the gateway to join.\n* `password` - (Required) The password of the user who has permission to add the gateway to the Active Directory domain.\n* `username` - (Required) The user name of user who has permission to add the gateway to the Active Directory domain.\n* `timeout_in_seconds` - (Optional) Specifies the time in seconds, in which the JoinDomain operation must complete. The default is `20` seconds.\n* `organizational_unit` - (Optional) The organizational unit (OU) is a container in an Active Directory that can hold users, groups,\n computers, and other OUs and this parameter specifies the OU that the gateway will join within the AD domain.\n* `domain_controllers` - (Optional) List of IPv4 addresses, NetBIOS names, or host names of your domain server.\n If you need to specify the port number include it after the colon (“:”). For example, `mydc.mydomain.com:389`.\n\n## Attribute Reference\n\nThis resource exports the following attributes in addition to the arguments above:\n\n* `id` - Amazon Resource Name (ARN) of the gateway.\n* `arn` - Amazon Resource Name (ARN) of the gateway.\n* `gateway_id` - Identifier of the gateway.\n* `ec2_instance_id` - The ID of the Amazon EC2 instance that was used to launch the gateway.\n* `endpoint_type` - The type of endpoint for your gateway.\n* `host_environment` - The type of hypervisor environment used by the host.\n* `gateway_network_interface` - An array that contains descriptions of the gateway network interfaces. See [Gateway Network Interface](#gateway-network-interface).\n* `tags_all` - A map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).\n\n### Gateway Network Interface\n\n* `ipv4_address` - The Internet Protocol version 4 (IPv4) address of the interface.\n\n## Timeouts\n\n[Configuration options](https://developer.hashicorp.com/terraform/language/resources/syntax#operation-timeouts):\n\n* `create` - (Default `10m`)\n\n## Import\n\nIn Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import `aws_storagegateway_gateway` using the gateway Amazon Resource Name (ARN). For example:\n\n```terraform\nimport {\n  to = aws_storagegateway_gateway.example\n  id = \"arn:aws:storagegateway:us-east-1:123456789012:gateway/sgw-12345678\"\n}\n```\n\nUsing `terraform import`, import `aws_storagegateway_gateway` using the gateway Amazon Resource Name (ARN). For example:\n\n```console\n% terraform import aws_storagegateway_gateway.example arn:aws:storagegateway:us-east-1:123456789012:gateway/sgw-12345678\n```\n\nCertain resource arguments, like `gateway_ip_address` do not have a Storage Gateway API method for reading the information after creation, either omit the argument from the Terraform configuration or use [`ignore_changes`](https://www.terraform.io/docs/configuration/meta-arguments/lifecycle.html#ignore_changes) to hide the difference. For example:\n\n```terraform\nresource \"aws_storagegateway_gateway\" \"example\" {\n  # ... other configuration ...\n\n  gateway_ip_address = aws_instance.sgw.private_ip\n  # There is no Storage Gateway API for reading gateway_ip_address\n  lifecycle {\n    ignore_changes = [\"gateway_ip_address\"]\n  }\n}\n```\n",
      "language": "hcl",
      "path": "website/docs/r/storagegateway_gateway.html.markdown",
      "slug": "storagegateway_gateway",
      "subcategory": "Storage Gateway",
      "title": "storagegateway_gateway",
      "truncated": false
    },
    "links": {
      "self": "/v2/provider-docs/3255879"
    }
  }
}