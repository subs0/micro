{
  "data": {
    "type": "provider-docs",
    "id": "3198574",
    "attributes": {
      "category": "resources",
      "content": "---\nsubcategory: \"ELB (Elastic Load Balancing)\"\nlayout: \"aws\"\npage_title: \"AWS: aws_lb_listener\"\ndescription: |-\n  Provides a Load Balancer Listener resource.\n---\n\n# Resource: aws_lb_listener\n\nProvides a Load Balancer Listener resource.\n\n~> **Note:** `aws_alb_listener` is known as `aws_lb_listener`. The functionality is identical.\n\n## Example Usage\n\n### Forward Action\n\n```terraform\nresource \"aws_lb\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_lb_target_group\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_lb_listener\" \"front_end\" {\n  load_balancer_arn = aws_lb.front_end.arn\n  port              = \"443\"\n  protocol          = \"HTTPS\"\n  ssl_policy        = \"ELBSecurityPolicy-2016-08\"\n  certificate_arn   = \"arn:aws:iam::187416307283:server-certificate/test_cert_rab3wuqwgja25ct3n4jdj2tzu4\"\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.front_end.arn\n  }\n}\n```\n\nTo a NLB:\n\n```hcl\nresource \"aws_lb_listener\" \"front_end\" {\n  load_balancer_arn = aws_lb.front_end.arn\n  port              = \"443\"\n  protocol          = \"TLS\"\n  certificate_arn   = \"arn:aws:iam::187416307283:server-certificate/test_cert_rab3wuqwgja25ct3n4jdj2tzu4\"\n  alpn_policy       = \"HTTP2Preferred\"\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.front_end.arn\n  }\n}\n```\n\n### Redirect Action\n\n```terraform\nresource \"aws_lb\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_lb_listener\" \"front_end\" {\n  load_balancer_arn = aws_lb.front_end.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    type = \"redirect\"\n\n    redirect {\n      port        = \"443\"\n      protocol    = \"HTTPS\"\n      status_code = \"HTTP_301\"\n    }\n  }\n}\n```\n\n### Fixed-response Action\n\n```terraform\nresource \"aws_lb\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_lb_listener\" \"front_end\" {\n  load_balancer_arn = aws_lb.front_end.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    type = \"fixed-response\"\n\n    fixed_response {\n      content_type = \"text/plain\"\n      message_body = \"Fixed response content\"\n      status_code  = \"200\"\n    }\n  }\n}\n```\n\n### Authenticate-cognito Action\n\n```terraform\nresource \"aws_lb\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_lb_target_group\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_cognito_user_pool\" \"pool\" {\n  # ...\n}\n\nresource \"aws_cognito_user_pool_client\" \"client\" {\n  # ...\n}\n\nresource \"aws_cognito_user_pool_domain\" \"domain\" {\n  # ...\n}\n\nresource \"aws_lb_listener\" \"front_end\" {\n  load_balancer_arn = aws_lb.front_end.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    type = \"authenticate-cognito\"\n\n    authenticate_cognito {\n      user_pool_arn       = aws_cognito_user_pool.pool.arn\n      user_pool_client_id = aws_cognito_user_pool_client.client.id\n      user_pool_domain    = aws_cognito_user_pool_domain.domain.domain\n    }\n  }\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.front_end.arn\n  }\n}\n```\n\n### Authenticate-OIDC Action\n\n```terraform\nresource \"aws_lb\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_lb_target_group\" \"front_end\" {\n  # ...\n}\n\nresource \"aws_lb_listener\" \"front_end\" {\n  load_balancer_arn = aws_lb.front_end.arn\n  port              = \"80\"\n  protocol          = \"HTTP\"\n\n  default_action {\n    type = \"authenticate-oidc\"\n\n    authenticate_oidc {\n      authorization_endpoint = \"https://example.com/authorization_endpoint\"\n      client_id              = \"client_id\"\n      client_secret          = \"client_secret\"\n      issuer                 = \"https://example.com\"\n      token_endpoint         = \"https://example.com/token_endpoint\"\n      user_info_endpoint     = \"https://example.com/user_info_endpoint\"\n    }\n  }\n\n  default_action {\n    type             = \"forward\"\n    target_group_arn = aws_lb_target_group.front_end.arn\n  }\n}\n```\n\n### Gateway Load Balancer Listener\n\n```terraform\nresource \"aws_lb\" \"example\" {\n  load_balancer_type = \"gateway\"\n  name               = \"example\"\n\n  subnet_mapping {\n    subnet_id = aws_subnet.example.id\n  }\n}\n\nresource \"aws_lb_target_group\" \"example\" {\n  name     = \"example\"\n  port     = 6081\n  protocol = \"GENEVE\"\n  vpc_id   = aws_vpc.example.id\n\n  health_check {\n    port     = 80\n    protocol = \"HTTP\"\n  }\n}\n\nresource \"aws_lb_listener\" \"example\" {\n  load_balancer_arn = aws_lb.example.id\n\n  default_action {\n    target_group_arn = aws_lb_target_group.example.id\n    type             = \"forward\"\n  }\n}\n```\n\n## Argument Reference\n\nThe following arguments are required:\n\n* `default_action` - (Required) Configuration block for default actions. Detailed below.\n* `load_balancer_arn` - (Required, Forces New Resource) ARN of the load balancer.\n\nThe following arguments are optional:\n\n* `alpn_policy` - (Optional)  Name of the Application-Layer Protocol Negotiation (ALPN) policy. Can be set if `protocol` is `TLS`. Valid values are `HTTP1Only`, `HTTP2Only`, `HTTP2Optional`, `HTTP2Preferred`, and `None`.\n* `certificate_arn` - (Optional) ARN of the default SSL server certificate. Exactly one certificate is required if the protocol is HTTPS. For adding additional SSL certificates, see the [`aws_lb_listener_certificate` resource](/docs/providers/aws/r/lb_listener_certificate.html).\n* `port` - (Optional) Port on which the load balancer is listening. Not valid for Gateway Load Balancers.\n* `protocol` - (Optional) Protocol for connections from clients to the load balancer. For Application Load Balancers, valid values are `HTTP` and `HTTPS`, with a default of `HTTP`. For Network Load Balancers, valid values are `TCP`, `TLS`, `UDP`, and `TCP_UDP`. Not valid to use `UDP` or `TCP_UDP` if dual-stack mode is enabled. Not valid for Gateway Load Balancers.\n* `ssl_policy` - (Optional) Name of the SSL Policy for the listener. Required if `protocol` is `HTTPS` or `TLS`.\n* `tags` - (Optional) A map of tags to assign to the resource. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.\n\n~> **NOTE::** Please note that listeners that are attached to Application Load Balancers must use either `HTTP` or `HTTPS` protocols while listeners that are attached to Network Load Balancers must use the `TCP` protocol.\n\n### default_action\n\nThe following arguments are required:\n\n* `type` - (Required) Type of routing action. Valid values are `forward`, `redirect`, `fixed-response`, `authenticate-cognito` and `authenticate-oidc`.\n\nThe following arguments are optional:\n\n* `authenticate_cognito` - (Optional) Configuration block for using Amazon Cognito to authenticate users. Specify only when `type` is `authenticate-cognito`. Detailed below.\n* `authenticate_oidc` - (Optional) Configuration block for an identity provider that is compliant with OpenID Connect (OIDC). Specify only when `type` is `authenticate-oidc`. Detailed below.\n* `fixed_response` - (Optional) Information for creating an action that returns a custom HTTP response. Required if `type` is `fixed-response`.\n* `forward` - (Optional) Configuration block for creating an action that distributes requests among one or more target groups. Specify only if `type` is `forward`. If you specify both `forward` block and `target_group_arn` attribute, you can specify only one target group using `forward` and it must be the same target group specified in `target_group_arn`. Detailed below.\n* `order` - (Optional) Order for the action. This value is required for rules with multiple actions. The action with the lowest value for order is performed first. Valid values are between `1` and `50000`.\n* `redirect` - (Optional) Configuration block for creating a redirect action. Required if `type` is `redirect`. Detailed below.\n* `target_group_arn` - (Optional) ARN of the Target Group to which to route traffic. Specify only if `type` is `forward` and you want to route to a single target group. To route to one or more target groups, use a `forward` block instead.\n\n#### authenticate_cognito\n\nThe following arguments are required:\n\n* `user_pool_arn` - (Required) ARN of the Cognito user pool.\n* `user_pool_client_id` - (Required) ID of the Cognito user pool client.\n* `user_pool_domain` - (Required) Domain prefix or fully-qualified domain name of the Cognito user pool.\n\nThe following arguments are optional:\n\n* `authentication_request_extra_params` - (Optional) Query parameters to include in the redirect request to the authorization endpoint. Max: 10. Detailed below.\n* `on_unauthenticated_request` - (Optional) Behavior if the user is not authenticated. Valid values are `deny`, `allow` and `authenticate`.\n* `scope` - (Optional) Set of user claims to be requested from the IdP.\n* `session_cookie_name` - (Optional) Name of the cookie used to maintain session information.\n* `session_timeout` - (Optional) Maximum duration of the authentication session, in seconds.\n\n##### authentication_request_extra_params\n\n* `key` - (Required) Key of query parameter.\n* `value` - (Required) Value of query parameter.\n\n#### authenticate_oidc\n\nThe following arguments are required:\n\n* `authorization_endpoint` - (Required) Authorization endpoint of the IdP.\n* `client_id` - (Required) OAuth 2.0 client identifier.\n* `client_secret` - (Required) OAuth 2.0 client secret.\n* `issuer` - (Required) OIDC issuer identifier of the IdP.\n* `token_endpoint` - (Required) Token endpoint of the IdP.\n* `user_info_endpoint` - (Required) User info endpoint of the IdP.\n\nThe following arguments are optional:\n\n* `authentication_request_extra_params` - (Optional) Query parameters to include in the redirect request to the authorization endpoint. Max: 10.\n* `on_unauthenticated_request` - (Optional) Behavior if the user is not authenticated. Valid values: `deny`, `allow` and `authenticate`\n* `scope` - (Optional) Set of user claims to be requested from the IdP.\n* `session_cookie_name` - (Optional) Name of the cookie used to maintain session information.\n* `session_timeout` - (Optional) Maximum duration of the authentication session, in seconds.\n\n#### fixed_response\n\nThe following arguments are required:\n\n* `content_type` - (Required) Content type. Valid values are `text/plain`, `text/css`, `text/html`, `application/javascript` and `application/json`.\n\nThe following arguments are optional:\n\n* `message_body` - (Optional) Message body.\n* `status_code` - (Optional) HTTP response code. Valid values are `2XX`, `4XX`, or `5XX`.\n\n#### forward\n\nThe following arguments are required:\n\n* `target_group` - (Required) Set of 1-5 target group blocks. Detailed below.\n\nThe following arguments are optional:\n\n* `stickiness` - (Optional) Configuration block for target group stickiness for the rule. Detailed below.\n\n##### target_group\n\nThe following arguments are required:\n\n* `arn` - (Required) ARN of the target group.\n\nThe following arguments are optional:\n\n* `weight` - (Optional) Weight. The range is 0 to 999.\n\n##### stickiness\n\nThe following arguments are required:\n\n* `duration` - (Required) Time period, in seconds, during which requests from a client should be routed to the same target group. The range is 1-604800 seconds (7 days).\n\nThe following arguments are optional:\n\n* `enabled` - (Optional) Whether target group stickiness is enabled. Default is `false`.\n\n#### redirect\n\n~> **NOTE::** You can reuse URI components using the following reserved keywords: `#{protocol}`, `#{host}`, `#{port}`, `#{path}` (the leading \"/\" is removed) and `#{query}`.\n\nThe following arguments are required:\n\n* `status_code` - (Required) HTTP redirect code. The redirect is either permanent (`HTTP_301`) or temporary (`HTTP_302`).\n\nThe following arguments are optional:\n\n* `host` - (Optional) Hostname. This component is not percent-encoded. The hostname can contain `#{host}`. Defaults to `#{host}`.\n* `path` - (Optional) Absolute path, starting with the leading \"/\". This component is not percent-encoded. The path can contain #{host}, #{path}, and #{port}. Defaults to `/#{path}`.\n* `port` - (Optional) Port. Specify a value from `1` to `65535` or `#{port}`. Defaults to `#{port}`.\n* `protocol` - (Optional) Protocol. Valid values are `HTTP`, `HTTPS`, or `#{protocol}`. Defaults to `#{protocol}`.\n* `query` - (Optional) Query parameters, URL-encoded when necessary, but not percent-encoded. Do not include the leading \"?\". Defaults to `#{query}`.\n\n## Attribute Reference\n\nThis resource exports the following attributes in addition to the arguments above:\n\n* `arn` - ARN of the listener (matches `id`).\n* `id` - ARN of the listener (matches `arn`).\n* `tags_all` - A map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).\n\n## Import\n\nIn Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import listeners using their ARN. For example:\n\n```terraform\nimport {\n  to = aws_lb_listener.front_end\n  id = \"arn:aws:elasticloadbalancing:us-west-2:187416307283:listener/app/front-end-alb/8e4497da625e2d8a/9ab28ade35828f96\"\n}\n```\n\nUsing `terraform import`, import listeners using their ARN. For example:\n\n```console\n% terraform import aws_lb_listener.front_end arn:aws:elasticloadbalancing:us-west-2:187416307283:listener/app/front-end-alb/8e4497da625e2d8a/9ab28ade35828f96\n```\n",
      "language": "hcl",
      "path": "website/docs/r/lb_listener.html.markdown",
      "slug": "lb_listener",
      "subcategory": "ELB (Elastic Load Balancing)",
      "title": "lb_listener",
      "truncated": false
    },
    "links": {
      "self": "/v2/provider-docs/3198574"
    }
  }
}