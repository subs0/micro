{
  "data": {
    "type": "provider-docs",
    "id": "3198138",
    "attributes": {
      "category": "resources",
      "content": "---\nsubcategory: \"Cognito Identity\"\nlayout: \"aws\"\npage_title: \"AWS: aws_cognito_identity_pool_roles_attachment\"\ndescription: |-\n  Provides an AWS Cognito Identity Pool Roles Attachment.\n---\n\n# Resource: aws_cognito_identity_pool_roles_attachment\n\nProvides an AWS Cognito Identity Pool Roles Attachment.\n\n## Example Usage\n\n```terraform\nresource \"aws_cognito_identity_pool\" \"main\" {\n  identity_pool_name               = \"identity pool\"\n  allow_unauthenticated_identities = false\n\n  supported_login_providers = {\n    \"graph.facebook.com\" = \"7346241598935555\"\n  }\n}\n\ndata \"aws_iam_policy_document\" \"authenticated\" {\n  statement {\n    effect = \"Allow\"\n\n    principals {\n      type        = \"Federated\"\n      identifiers = [\"cognito-identity.amazonaws.com\"]\n    }\n\n    actions = [\"sts:AssumeRoleWithWebIdentity\"]\n\n    condition {\n      test     = \"StringEquals\"\n      variable = \"cognito-identity.amazonaws.com:aud\"\n      values   = [aws_cognito_identity_pool.main.id]\n    }\n\n    condition {\n      test     = \"ForAnyValue:StringLike\"\n      variable = \"cognito-identity.amazonaws.com:amr\"\n      values   = [\"authenticated\"]\n    }\n  }\n}\n\nresource \"aws_iam_role\" \"authenticated\" {\n  name               = \"cognito_authenticated\"\n  assume_role_policy = data.aws_iam_policy_document.authenticated.json\n}\n\ndata \"aws_iam_policy_document\" \"authenticated_role_policy\" {\n  statement {\n    effect = \"Allow\"\n\n    actions = [\n      \"mobileanalytics:PutEvents\",\n      \"cognito-sync:*\",\n      \"cognito-identity:*\",\n    ]\n\n    resources = [\"*\"]\n  }\n}\n\nresource \"aws_iam_role_policy\" \"authenticated\" {\n  name   = \"authenticated_policy\"\n  role   = aws_iam_role.authenticated.id\n  policy = data.aws_iam_policy_document.authenticated_role_policy.json\n}\n\nresource \"aws_cognito_identity_pool_roles_attachment\" \"main\" {\n  identity_pool_id = aws_cognito_identity_pool.main.id\n\n  role_mapping {\n    identity_provider         = \"graph.facebook.com\"\n    ambiguous_role_resolution = \"AuthenticatedRole\"\n    type                      = \"Rules\"\n\n    mapping_rule {\n      claim      = \"isAdmin\"\n      match_type = \"Equals\"\n      role_arn   = aws_iam_role.authenticated.arn\n      value      = \"paid\"\n    }\n  }\n\n  roles = {\n    \"authenticated\" = aws_iam_role.authenticated.arn\n  }\n}\n```\n\n## Argument Reference\n\nThe Cognito Identity Pool Roles Attachment argument layout is a structure composed of several sub-resources - these resources are laid out below.\n\n* `identity_pool_id` (Required) - An identity pool ID in the format `REGION_GUID`.\n* `role_mapping` (Optional) - A List of [Role Mapping](#role-mappings).\n* `roles` (Required) - The map of roles associated with this pool. For a given role, the key will be either \"authenticated\" or \"unauthenticated\" and the value will be the Role ARN.\n\n#### Role Mappings\n\n* `identity_provider` (Required) - A string identifying the identity provider, for example, \"graph.facebook.com\" or \"cognito-idp.us-east-1.amazonaws.com/us-east-1_abcdefghi:app_client_id\". Depends on `cognito_identity_providers` set on `aws_cognito_identity_pool` resource or a `aws_cognito_identity_provider` resource.\n* `ambiguous_role_resolution` (Optional) - Specifies the action to be taken if either no rules match the claim value for the Rules type, or there is no cognito:preferred_role claim and there are multiple cognito:roles matches for the Token type. `Required` if you specify Token or Rules as the Type.\n* `mapping_rule` (Optional) - The [Rules Configuration](#rules-configuration) to be used for mapping users to roles. You can specify up to 25 rules per identity provider. Rules are evaluated in order. The first one to match specifies the role.\n* `type` (Required) - The role mapping type.\n\n#### Rules Configuration\n\n* `claim` (Required) - The claim name that must be present in the token, for example, \"isAdmin\" or \"paid\".\n* `match_type` (Required) - The match condition that specifies how closely the claim value in the IdP token must match Value.\n* `role_arn` (Required) - The role ARN.\n* `value` (Required) - A brief string that the claim must match, for example, \"paid\" or \"yes\".\n\n## Attribute Reference\n\nThis resource exports the following attributes in addition to the arguments above:\n\n* `id` - The identity pool ID.\n\n## Import\n\nIn Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import Cognito Identity Pool Roles Attachment using the Identity Pool ID. For example:\n\n```terraform\nimport {\n  to = aws_cognito_identity_pool_roles_attachment.example\n  id = \"us-west-2:b64805ad-cb56-40ba-9ffc-f5d8207e6d42\"\n}\n```\n\nUsing `terraform import`, import Cognito Identity Pool Roles Attachment using the Identity Pool ID. For example:\n\n```console\n% terraform import aws_cognito_identity_pool_roles_attachment.example us-west-2:b64805ad-cb56-40ba-9ffc-f5d8207e6d42\n```\n",
      "language": "hcl",
      "path": "website/docs/r/cognito_identity_pool_roles_attachment.html.markdown",
      "slug": "cognito_identity_pool_roles_attachment",
      "subcategory": "Cognito Identity",
      "title": "cognito_identity_pool_roles_attachment",
      "truncated": false
    },
    "links": {
      "self": "/v2/provider-docs/3198138"
    }
  }
}