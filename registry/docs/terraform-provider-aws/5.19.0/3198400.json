{
  "data": {
    "type": "provider-docs",
    "id": "3198400",
    "attributes": {
      "category": "resources",
      "content": "---\nsubcategory: \"VPC (Virtual Private Cloud)\"\nlayout: \"aws\"\npage_title: \"AWS: aws_flow_log\"\ndescription: |-\n  Provides a VPC/Subnet/ENI Flow Log\n---\n\n# Resource: aws_flow_log\n\nProvides a VPC/Subnet/ENI/Transit Gateway/Transit Gateway Attachment Flow Log to capture IP traffic for a specific network\ninterface, subnet, or VPC. Logs are sent to a CloudWatch Log Group, a S3 Bucket, or Amazon Kinesis Data Firehose\n\n## Example Usage\n\n### CloudWatch Logging\n\n```terraform\nresource \"aws_flow_log\" \"example\" {\n  iam_role_arn    = aws_iam_role.example.arn\n  log_destination = aws_cloudwatch_log_group.example.arn\n  traffic_type    = \"ALL\"\n  vpc_id          = aws_vpc.example.id\n}\n\nresource \"aws_cloudwatch_log_group\" \"example\" {\n  name = \"example\"\n}\n\ndata \"aws_iam_policy_document\" \"assume_role\" {\n  statement {\n    effect = \"Allow\"\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"vpc-flow-logs.amazonaws.com\"]\n    }\n\n    actions = [\"sts:AssumeRole\"]\n  }\n}\n\nresource \"aws_iam_role\" \"example\" {\n  name               = \"example\"\n  assume_role_policy = data.aws_iam_policy_document.assume_role.json\n}\n\ndata \"aws_iam_policy_document\" \"example\" {\n  statement {\n    effect = \"Allow\"\n\n    actions = [\n      \"logs:CreateLogGroup\",\n      \"logs:CreateLogStream\",\n      \"logs:PutLogEvents\",\n      \"logs:DescribeLogGroups\",\n      \"logs:DescribeLogStreams\",\n    ]\n\n    resources = [\"*\"]\n  }\n}\n\nresource \"aws_iam_role_policy\" \"example\" {\n  name   = \"example\"\n  role   = aws_iam_role.example.id\n  policy = data.aws_iam_policy_document.example.json\n}\n```\n\n### Amazon Kinesis Data Firehose logging\n\n```terraform\nresource \"aws_flow_log\" \"example\" {\n  log_destination      = aws_kinesis_firehose_delivery_stream.example.arn\n  log_destination_type = \"kinesis-data-firehose\"\n  traffic_type         = \"ALL\"\n  vpc_id               = aws_vpc.example.id\n}\n\nresource \"aws_kinesis_firehose_delivery_stream\" \"example\" {\n  name        = \"kinesis_firehose_test\"\n  destination = \"extended_s3\"\n\n  extended_s3_configuration {\n    role_arn   = aws_iam_role.example.arn\n    bucket_arn = aws_s3_bucket.example.arn\n  }\n\n  tags = {\n    \"LogDeliveryEnabled\" = \"true\"\n  }\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n\nresource \"aws_s3_bucket_acl\" \"example\" {\n  bucket = aws_s3_bucket.example.id\n  acl    = \"private\"\n}\n\ndata \"aws_iam_policy_document\" \"assume_role\" {\n  statement {\n    effect = \"Allow\"\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"firehose.amazonaws.com\"]\n    }\n\n    actions = [\"sts:AssumeRole\"]\n  }\n}\n\nresource \"aws_iam_role\" \"example\" {\n  name               = \"firehose_test_role\"\n  assume_role_policy = data.aws_iam_policy_document.assume_role.json\n}\n\ndata \"aws_iam_policy_document\" \"example\" {\n  effect = \"Allow\"\n\n  actions = [\n    \"logs:CreateLogDelivery\",\n    \"logs:DeleteLogDelivery\",\n    \"logs:ListLogDeliveries\",\n    \"logs:GetLogDelivery\",\n    \"firehose:TagDeliveryStream\",\n  ]\n\n  resources = [\"*\"]\n}\n\nresource \"aws_iam_role_policy\" \"example\" {\n  name   = \"test\"\n  role   = aws_iam_role.example.id\n  policy = data.aws_iam_policy_document.example.json\n}\n```\n\n### S3 Logging\n\n```terraform\nresource \"aws_flow_log\" \"example\" {\n  log_destination      = aws_s3_bucket.example.arn\n  log_destination_type = \"s3\"\n  traffic_type         = \"ALL\"\n  vpc_id               = aws_vpc.example.id\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n```\n\n### S3 Logging in Apache Parquet format with per-hour partitions\n\n```terraform\nresource \"aws_flow_log\" \"example\" {\n  log_destination      = aws_s3_bucket.example.arn\n  log_destination_type = \"s3\"\n  traffic_type         = \"ALL\"\n  vpc_id               = aws_vpc.example.id\n  destination_options {\n    file_format        = \"parquet\"\n    per_hour_partition = true\n  }\n}\n\nresource \"aws_s3_bucket\" \"example\" {\n  bucket = \"example\"\n}\n```\n\n## Argument Reference\n\n~> **NOTE:** One of `eni_id`, `subnet_id`, `transit_gateway_id`, `transit_gateway_attachment_id`, or `vpc_id` must be specified.\n\nThis argument supports the following arguments:\n\n* `traffic_type` - (Required) The type of traffic to capture. Valid values: `ACCEPT`,`REJECT`, `ALL`.\n* `deliver_cross_account_role` - (Optional) ARN of the IAM role that allows Amazon EC2 to publish flow logs across accounts.\n* `eni_id` - (Optional) Elastic Network Interface ID to attach to\n* `iam_role_arn` - (Optional) The ARN for the IAM role that's used to post flow logs to a CloudWatch Logs log group\n* `log_destination_type` - (Optional) The type of the logging destination. Valid values: `cloud-watch-logs`, `s3`, `kinesis-data-firehose`. Default: `cloud-watch-logs`.\n* `log_destination` - (Optional) The ARN of the logging destination. Either `log_destination` or `log_group_name` must be set.\n* `log_group_name` - (Optional) **Deprecated:** Use `log_destination` instead. The name of the CloudWatch log group. Either `log_group_name` or `log_destination` must be set.\n* `subnet_id` - (Optional) Subnet ID to attach to\n* `transit_gateway_id` - (Optional) Transit Gateway ID to attach to\n* `transit_gateway_attachment_id` - (Optional) Transit Gateway Attachment ID to attach to\n* `vpc_id` - (Optional) VPC ID to attach to\n* `log_format` - (Optional) The fields to include in the flow log record, in the order in which they should appear.\n* `max_aggregation_interval` - (Optional) The maximum interval of time\n  during which a flow of packets is captured and aggregated into a flow\n  log record. Valid Values: `60` seconds (1 minute) or `600` seconds (10\n  minutes). Default: `600`. When `transit_gateway_id` or `transit_gateway_attachment_id` is specified, `max_aggregation_interval` *must* be 60 seconds (1 minute).\n* `destination_options` - (Optional) Describes the destination options for a flow log. More details below.\n* `tags` - (Optional) Key-value map of resource tags. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.\n\n### destination_options\n\nDescribes the destination options for a flow log.\n\n* `file_format` - (Optional) The format for the flow log. Default value: `plain-text`. Valid values: `plain-text`, `parquet`.\n* `hive_compatible_partitions` - (Optional) Indicates whether to use Hive-compatible prefixes for flow logs stored in Amazon S3. Default value: `false`.\n* `per_hour_partition` - (Optional) Indicates whether to partition the flow log per hour. This reduces the cost and response time for queries. Default value: `false`.\n\n## Attribute Reference\n\nThis resource exports the following attributes in addition to the arguments above:\n\n* `id` - The Flow Log ID\n* `arn` - The ARN of the Flow Log.\n* `tags_all` - A map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).\n\n## Import\n\nIn Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import Flow Logs using the `id`. For example:\n\n```terraform\nimport {\n  to = aws_flow_log.test_flow_log\n  id = \"fl-1a2b3c4d\"\n}\n```\n\nUsing `terraform import`, import Flow Logs using the `id`. For example:\n\n```console\n% terraform import aws_flow_log.test_flow_log fl-1a2b3c4d\n```\n",
      "language": "hcl",
      "path": "website/docs/r/flow_log.html.markdown",
      "slug": "flow_log",
      "subcategory": "VPC (Virtual Private Cloud)",
      "title": "flow_log",
      "truncated": false
    },
    "links": {
      "self": "/v2/provider-docs/3198400"
    }
  }
}