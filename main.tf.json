{
    "data": {
        "aws_iam_policy_document": {
            "policy_doc": {
                "statement": {
                    "effect": "Allow",
                    "actions": [
                        "sts:AssumeRole"
                    ],
                    "principals": {
                        "identifiers": [
                            "lambda.amazonaws.com"
                        ],
                        "type": "Service"
                    }
                }
            }
        }
    },
    "resource": {
        "aws_iam_role": {
            "role": {
                "name": "throwaway-role",
                "assume_role_policy": "${data.aws_iam_policy_document.policy_doc.json}"
            }
        },
        "aws_s3_bucket": {
            "bucket": {
                "bucket": "throwaway-bucket-pqewur"
            }
        },
        "aws_lambda_function": {
            "pig": {
                "function_name": "pig",
                "role": "${resource.aws_iam_role.role.arn}",
                "description": "A pig lambda",
                "filename": "lambdas/template/zipped/handler.py.zip",
                "handler": "handler.handler",
                "runtime": "python3.8",
                "environment": {
                    "variables": {
                        "FOO": "bar",
                        "S3_BUCKET": "${resource.aws_s3_bucket.bucket.bucket}"
                    }
                }
            }
        }
    },
    "provider": [
        {
            "aws": {
                "region": "us-east-2",
                "profile": "chopshop"
            }
        }
    ]
}