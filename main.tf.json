{
    "data": {
        "aws_iam_policy_document": {
            "out_policy_doc": {
                "statement": {
                    "effect": "Allow",
                    "actions": [
                        "sts:AssumeRole"
                    ],
                    "principals": {
                        "identifiers": [
                            "lambda.amazonaws.com"
                        ],
                        "type": "Service"
                    }
                }
            }
        }
    },
    "resource": {
        "aws_iam_role": {
            "out_role": {
                "name": "throwaway-role",
                "assume_role_policy": "${data.aws_iam_policy_document.out_policy_doc.json}"
            }
        },
        "aws_s3_bucket": {
            "out_bucket": {
                "bucket": "throwaway-bucket-omgbby"
            }
        },
        "aws_lambda_function": {
            "out_lambda": {
                "function_name": "throwaway-lambda",
                "role": "${resource.aws_iam_role.out_role.arn}",
                "description": "A throwaway lambda",
                "filename": "${path.root}/lambdas/template/zipped/handler.py.zip",
                "handler": "handler.handler",
                "runtime": "python3.8",
                "environment": {
                    "variables": {
                        "FOO": "bar",
                        "S3_BUCKET": "${resource.aws_s3_bucket.out_bucket.bucket}"
                    }
                }
            }
        }
    },
    "provider": [
        {
            "aws": {
                "region": "us-east-2",
                "profile": "chopshop"
            }
        }
    ]
}