{
    "subcategory: \"WAF\"": {
        "layout: \"aws\"": {
            "page_title: \"AWS: aws_wafv2_rule_group\"": "---\ndescription: |-\n  Creates a WAFv2 rule group resource.\n---\n\n# Resource: aws_wafv2_rule_group\n\nCreates a WAFv2 Rule Group resource."
        }
    },
    "Example Usage": {
        "Simple": {
            "```terraform": "\n\nresource \"aws_wafv2_rule_group\" \"example\" {\n  name     = \"example-rule\"\n  scope    = \"REGIONAL\"\n  capacity = 2\n\n  rule {\n    name     = \"rule-1\"\n    priority = 1\n\n    action {\n      allow {}\n    }\n\n    statement {\n\n      geo_match_statement {\n        country_codes = [\"US\", \"NL\"]\n      }\n    }\n\n    visibility_config {\n      cloudwatch_metrics_enabled = false\n      metric_name                = \"friendly-rule-metric-name\"\n      sampled_requests_enabled   = false\n    }\n  }\n\n  visibility_config {\n    cloudwatch_metrics_enabled = false\n    metric_name                = \"friendly-metric-name\"\n    sampled_requests_enabled   = false\n  }\n}\n```"
        },
        "Complex": {
            "```terraform": "\n\nresource \"aws_wafv2_ip_set\" \"test\" {\n  name               = \"test\"\n  scope              = \"REGIONAL\"\n  ip_address_version = \"IPV4\"\n  addresses          = [\"1.1.1.1/32\", \"2.2.2.2/32\"]\n}\n\nresource \"aws_wafv2_regex_pattern_set\" \"test\" {\n  name  = \"test\"\n  scope = \"REGIONAL\"\n\n  regular_expression {\n    regex_string = \"one\"\n  }\n}\n\nresource \"aws_wafv2_rule_group\" \"example\" {\n  name        = \"complex-example\"\n  description = \"An rule group containing all statements\"\n  scope       = \"REGIONAL\"\n  capacity    = 500\n\n  rule {\n    name     = \"rule-1\"\n    priority = 1\n\n    action {\n      block {}\n    }\n\n    statement {\n\n      not_statement {\n        statement {\n\n          and_statement {\n            statement {\n\n              geo_match_statement {\n                country_codes = [\"US\"]\n              }\n            }\n\n            statement {\n\n              byte_match_statement {\n                positional_constraint = \"CONTAINS\"\n                search_string         = \"word\"\n\n                field_to_match {\n                  all_query_arguments {}\n                }\n\n                text_transformation {\n                  priority = 5\n                  type     = \"CMD_LINE\"\n                }\n\n                text_transformation {\n                  priority = 2\n                  type     = \"LOWERCASE\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n\n    visibility_config {\n      cloudwatch_metrics_enabled = false\n      metric_name                = \"rule-1\"\n      sampled_requests_enabled   = false\n    }\n  }\n\n  rule {\n    name     = \"rule-2\"\n    priority = 2\n\n    action {\n      count {}\n    }\n\n    statement {\n\n      or_statement {\n        statement {\n\n          regex_match_statement {\n\n            regex_string = \"[a-z]([a-z0-9_-]*[a-z0-9])?\"\n\n            field_to_match {\n              single_header {\n                name = \"user-agent\"\n              }\n            }\n\n            text_transformation {\n              priority = 6\n              type     = \"NONE\"\n            }\n          }\n        }\n\n        statement {\n\n          sqli_match_statement {\n\n            field_to_match {\n              body {}\n            }\n\n            text_transformation {\n              priority = 5\n              type     = \"URL_DECODE\"\n            }\n\n            text_transformation {\n              priority = 4\n              type     = \"HTML_ENTITY_DECODE\"\n            }\n\n            text_transformation {\n              priority = 3\n              type     = \"COMPRESS_WHITE_SPACE\"\n            }\n          }\n        }\n\n        statement {\n\n          xss_match_statement {\n\n            field_to_match {\n              method {}\n            }\n\n            text_transformation {\n              priority = 2\n              type     = \"NONE\"\n            }\n          }\n        }\n      }\n    }\n\n    visibility_config {\n      cloudwatch_metrics_enabled = false\n      metric_name                = \"rule-2\"\n      sampled_requests_enabled   = false\n    }\n\n    captcha_config {\n      immunity_time_property {\n        immunity_time = 240\n      }\n    }\n  }\n\n  rule {\n    name     = \"rule-3\"\n    priority = 3\n\n    action {\n      block {}\n    }\n\n    statement {\n\n      size_constraint_statement {\n        comparison_operator = \"GT\"\n        size                = 100\n\n        field_to_match {\n          single_query_argument {\n            name = \"username\"\n          }\n        }\n\n        text_transformation {\n          priority = 5\n          type     = \"NONE\"\n        }\n      }\n    }\n\n    visibility_config {\n      cloudwatch_metrics_enabled = false\n      metric_name                = \"rule-3\"\n      sampled_requests_enabled   = false\n    }\n  }\n\n  rule {\n    name     = \"rule-4\"\n    priority = 4\n\n    action {\n      block {}\n    }\n\n    statement {\n\n      or_statement {\n        statement {\n\n          ip_set_reference_statement {\n            arn = aws_wafv2_ip_set.test.arn\n          }\n        }\n\n        statement {\n\n          regex_pattern_set_reference_statement {\n            arn = aws_wafv2_regex_pattern_set.test.arn\n\n            field_to_match {\n              single_header {\n                name = \"referer\"\n              }\n            }\n\n            text_transformation {\n              priority = 2\n              type     = \"NONE\"\n            }\n          }\n        }\n      }\n    }\n\n    visibility_config {\n      cloudwatch_metrics_enabled = false\n      metric_name                = \"rule-4\"\n      sampled_requests_enabled   = false\n    }\n  }\n\n  visibility_config {\n    cloudwatch_metrics_enabled = false\n    metric_name                = \"friendly-metric-name\"\n    sampled_requests_enabled   = false\n  }\n\n  captcha_config {\n    immunity_time_property {\n      immunity_time = 120\n    }\n  }\n\n  tags = {\n    Name = \"example-and-statement\"\n    Code = \"123456\"\n  }\n}\n```"
        }
    },
    "Argument Reference": {
        "capacity": "(Required, Forces new resource) The web ACL capacity units (WCUs) required for this rule group. See [here](https://docs.aws.amazon.com/waf/latest/APIReference/API_CreateRuleGroup.html#API_CreateRuleGroup_RequestSyntax) for general information and [here](https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statements-list.html) for capacity specific information.",
        "custom_response_body": {
            "key!": "(Required) A unique key identifying the custom response body. This is referenced by the `custom_response_body_key` argument in the [Custom Response](#custom-response) block.",
            "content!": "(Required) The payload of the custom response.",
            "content_type!": "(Required) The type of content in the payload that you are defining in the `content` argument. Valid values are `TEXT_PLAIN`, `TEXT_HTML`, or `APPLICATION_JSON`."
        },
        "description": "(Optional) A friendly description of the rule group.",
        "name": "(Optional) The name of the query header to inspect. This setting must be provided as lower case characters.\n\n### Cookies\n\nInspect the cookies in the web request. You can specify the parts of the cookies to inspect and you can narrow the set of cookies to inspect by including or excluding specific keys.\nThis is used to indicate the web request component to inspect, in the [FieldToMatch](https://docs.aws.amazon.com/waf/latest/APIReference/API_FieldToMatch.html) specification.\n\nThe `cookies` block supports the following arguments:\n",
        "rule": "(Optional) The rule blocks used to identify the web requests that you want to `allow`, `block`, or `count`. See [Rules](#rules) below for details.",
        "scope": "(Required, Forces new resource) Specifies whether this is for an AWS CloudFront distribution or for a regional application. Valid values are `CLOUDFRONT` or `REGIONAL`. To work with CloudFront, you must also specify the region `us-east-1` (N. Virginia) on the AWS provider.",
        "tags": "(Optional) An array of key:value pairs to associate with the resource. If configured with a provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block) present, tags with matching keys will overwrite those defined at the provider-level.",
        "visibility_config!": "(Required) Defines and enables Amazon CloudWatch metrics and web request sample collection. See [Visibility Configuration](#visibility-configuration) below for details.\n\n### Action\n\nThe `action` block supports the following arguments:\n\n",
        "key!": "(Required) The string to match against.\n\n### IP Set Reference Statement\n\nA rule statement used to detect web requests coming from particular IP addresses or address ranges. To use this, create an `aws_wafv2_ip_set` that specifies the addresses you want to detect, then use the `ARN` of that set in this statement.\n\nThe `ip_set_reference_statement` block supports the following arguments:\n",
        "content!": "(Required) The payload of the custom response.",
        "content_type!": "(Required) The type of content in the payload that you are defining in the `content` argument. Valid values are `TEXT_PLAIN`, `TEXT_HTML`, or `APPLICATION_JSON`.\n\n### Rules\n\nEach `rule` supports the following arguments:\n",
        "action!": {
            "allow": "(Optional) Instructs AWS WAF to allow the web request. See [Allow](#action) below for details.",
            "block": "(Optional) Instructs AWS WAF to block the web request. See [Block](#block) below for details.",
            "captcha": "(Optional) Instructs AWS WAF to run a `CAPTCHA` check against the web request. See [Captcha](#captcha) below for details.",
            "challenge": "(Optional) Instructs AWS WAF to run a check against the request to verify that the request is coming from a legitimate client session. See [Challenge](#challenge) below for details.",
            "count": "(Optional) Instructs AWS WAF to count the web request and allow it. See [Count](#count) below for details."
        },
        "captcha_config": "(Optional) Specifies how AWS WAF should handle CAPTCHA evaluations. See [Captcha Configuration](#captcha-configuration) below for details.",
        "priority!": "(Required) The relative processing order for multiple transformations that are defined for a rule statement. AWS WAF processes all transformations, from lowest priority to highest, before inspecting the transformed content.",
        "rule_label": { "name": "The label string." },
        "statement!": {
            "and_statement": "(Optional) A logical rule statement used to combine other rule statements with AND logic. See [AND Statement](#and-statement) below for details.",
            "byte_match_statement": "(Optional) A rule statement that defines a string match search for AWS WAF to apply to web requests. See [Byte Match Statement](#byte-match-statement) below for details.",
            "geo_match_statement": "(Optional) A rule statement used to identify web requests based on country of origin. See [GEO Match Statement](#geo-match-statement) below for details.",
            "label_match_statement": "(Optional) A rule statement that defines a string match search against labels that have been added to the web request by rules that have already run in the web ACL. See [Label Match Statement](#label-match-statement) below for details.",
            "ip_set_reference_statement": "(Optional) A rule statement used to detect web requests coming from particular IP addresses or address ranges. See [IP Set Reference Statement](#ip-set-reference-statement) below for details.",
            "not_statement": "(Optional) A logical rule statement used to negate the results of another rule statement. See [NOT Statement](#not-statement) below for details.",
            "or_statement": "(Optional) A logical rule statement used to combine other rule statements with OR logic. See [OR Statement](#or-statement) below for details.",
            "rate_based_statement": "(Optional) A rate-based rule tracks the rate of requests for each originating `IP address`, and triggers the rule action when the rate exceeds a limit that you specify on the number of requests in any `5-minute` time span. This statement can not be nested. See [Rate Based Statement](#rate-based-statement) below for details.",
            "regex_match_statement": "(Optional) A rule statement used to search web request components for a match against a single regular expression. See [Regex Match Statement](#regex-match-statement) below for details.",
            "regex_pattern_set_reference_statement": "(Optional) A rule statement used to search web request components for matches with regular expressions. See [Regex Pattern Set Reference Statement](#regex-pattern-set-reference-statement) below for details.",
            "size_constraint_statement": "(Optional) A rule statement that compares a number of bytes against the size of a request component, using a comparison operator, such as greater than (>) or less than (<). See [Size Constraint Statement](#size-constraint-statement) below for more details.",
            "sqli_match_statement": "(Optional) An SQL injection match condition identifies the part of web requests, such as the URI or the query string, that you want AWS WAF to inspect. See [SQL Injection Match Statement](#sql-injection-match-statement) below for details.",
            "xss_match_statement": "(Optional) A rule statement that defines a cross-site scripting (XSS) match search for AWS WAF to apply to web requests. See [XSS Match Statement](#xss-match-statement) below for details."
        },
        "allow": {
            "custom_request_handling": "(Optional) Defines custom handling for the web request. See [Custom Request Handling](#custom-request-handling) below for details."
        },
        "block": {
            "custom_response": "(Optional) Defines a custom response for the web request. See [Custom Response](#custom-response) below for details."
        },
        "captcha": {
            "custom_request_handling": "(Optional) Defines custom handling for the web request. See [Custom Request Handling](#custom-request-handling) below for details."
        },
        "challenge": "(Optional) Instructs AWS WAF to run a check against the request to verify that the request is coming from a legitimate client session. See [Challenge](#challenge) below for details.",
        "count": {
            "custom_request_handling": "(Optional) Defines custom handling for the web request. See [Custom Request Handling](#custom-request-handling) below for details."
        },
        "custom_request_handling": {
            "insert_header!": "(Required) The `insert_header` blocks used to define HTTP headers added to the request. See [Custom HTTP Header](#custom-http-header) below for details."
        },
        "custom_response": {
            "custom_response_body_key": "(Optional) References the response body that you want AWS WAF to return to the web request client. This must reference a `key` defined in a `custom_response_body` block of this resource.",
            "response_code!": "(Required) The HTTP status code to return to the client.",
            "response_header": "(Optional) The `response_header` blocks used to define the HTTP response headers added to the response. See [Custom HTTP Header](#custom-http-header) below for details."
        },
        "insert_header!": "(Required) The `insert_header` blocks used to define HTTP headers added to the request. See [Custom HTTP Header](#custom-http-header) below for details.\n\n### Custom Response\n\nThe `custom_response` block supports the following arguments:\n",
        "custom_response_body_key": "(Optional) References the response body that you want AWS WAF to return to the web request client. This must reference a `key` defined in a `custom_response_body` block of this resource.",
        "response_code!": "(Required) The HTTP status code to return to the client.",
        "response_header": "(Optional) The `response_header` blocks used to define the HTTP response headers added to the response. See [Custom HTTP Header](#custom-http-header) below for details.\n\n### Custom HTTP Header\n\nEach block supports the following arguments. Duplicate header names are not allowed:\n",
        "value": "The value of the custom header.\n\n### Rule Label\n\nEach block supports the following arguments:\n",
        "and_statement": {
            "statement!": "(Required) The statements to combine with `AND` logic. You can use any statements that can be nested. See [Statement](#statement) above for details."
        },
        "byte_match_statement": {
            "field_to_match!": "(Required) The part of a web request that you want AWS WAF to inspect. See [Field to Match](#field-to-match) below for details.",
            "positional_constraint!": "(Required) The area within the portion of a web request that you want AWS WAF to search for `search_string`. Valid values include the following: `EXACTLY`, `STARTS_WITH`, `ENDS_WITH`, `CONTAINS`, `CONTAINS_WORD`. See the AWS [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_ByteMatchStatement.html) for more information.",
            "search_string!": "(Required) A string value that you want AWS WAF to search for. AWS WAF searches only in the part of web requests that you designate for inspection in `field_to_match`. The maximum length of the value is 50 bytes.",
            "text_transformation!": "(Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection.\n  At least one required.\n  See [Text Transformation](#text-transformation) below for details."
        },
        "geo_match_statement": {
            "country_codes!": "(Required) An array of two-character country codes, for example, [ \"US\", \"CN\" ], from the alpha-2 country ISO codes of the `ISO 3166` international standard. See the [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_GeoMatchStatement.html) for valid values.",
            "forwarded_ip_config": "(Optional) The configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. See [Forwarded IP Config](#forwarded-ip-config) below for details."
        },
        "label_match_statement": {
            "scope!": "(Required) Specify whether you want to match using the label name or just the namespace. Valid values are `LABEL` or `NAMESPACE`.",
            "key!": "(Required) The string to match against."
        },
        "ip_set_reference_statement": {
            "arn!": "(Required) The Amazon Resource Name (ARN) of the IP Set that this statement references.",
            "ip_set_forwarded_ip_config": "(Optional) The configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. See [IPSet Forwarded IP Config](#ipset-forwarded-ip-config) below for more details."
        },
        "not_statement": {
            "statement!": "(Required) The statement to negate. You can use any statement that can be nested. See [Statement](#statement) above for details."
        },
        "or_statement": {
            "statement!": "(Required) The statements to combine with `OR` logic. You can use any statements that can be nested. See [Statement](#statement) above for details."
        },
        "rate_based_statement": {
            "aggregate_key_type": "(Optional) Setting that indicates how to aggregate the request counts. Valid values include: `CONSTANT`, `CUSTOM_KEYS`, `FORWARDED_IP` or `IP`. Default: `IP`.",
            "custom_key": "(Optional) Aggregate the request counts using one or more web request components as the aggregate keys. See [`custom_key`](#custom_key-block) below for details.",
            "forwarded_ip_config": "(Optional) The configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. If `aggregate_key_type` is set to `FORWARDED_IP`, this block is required. See [Forwarded IP Config](#forwarded-ip-config) below for details.",
            "limit!": "(Required) The limit on requests per 5-minute period for a single originating IP address.",
            "scope_down_statement": "(Optional) An optional nested statement that narrows the scope of the rate-based statement to matching web requests. This can be any nestable statement, and you can nest statements at any level below this scope-down statement. See [Statement](#statement) above for details. If `aggregate_key_type` is set to `CONSTANT`, this block is required."
        },
        "regex_match_statement": {
            "regex_string!": "(Required) The string representing the regular expression. Minimum of `1` and maximum of `512` characters.",
            "field_to_match!": "(Required) The part of a web request that you want AWS WAF to inspect. See [Field to Match](#field-to-match) below for details.",
            "text_transformation!": "(Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection.\n  At least one required.\n  See [Text Transformation](#text-transformation) below for details."
        },
        "regex_pattern_set_reference_statement": {
            "arn!": "(Required) The Amazon Resource Name (ARN) of the Regex Pattern Set that this statement references.",
            "field_to_match!": "(Required) The part of a web request that you want AWS WAF to inspect. See [Field to Match](#field-to-match) below for details.",
            "text_transformation!": "(Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection.\n  At least one required.\n  See [Text Transformation](#text-transformation) below for details."
        },
        "size_constraint_statement": {
            "comparison_operator!": "(Required) The operator to use to compare the request part to the size setting. Valid values include: `EQ`, `NE`, `LE`, `LT`, `GE`, or `GT`.",
            "field_to_match": "(Optional) The part of a web request that you want AWS WAF to inspect. See [Field to Match](#field-to-match) below for details.",
            "size!": "(Required) The size, in bytes, to compare to the request part, after any transformations. Valid values are integers between 0 and 21474836480, inclusive.",
            "text_transformation!": "(Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection.\n  At least one required.\n  See [Text Transformation](#text-transformation) below for details."
        },
        "sqli_match_statement": "(Optional) An SQL injection match condition identifies the part of web requests, such as the URI or the query string, that you want AWS WAF to inspect. See [SQL Injection Match Statement](#sql-injection-match-statement) below for details.",
        "xss_match_statement": {
            "field_to_match!": "(Required) The part of a web request that you want AWS WAF to inspect. See [Field to Match](#field-to-match) below for details.",
            "text_transformation!": "(Required) Text transformations eliminate some of the unusual formatting that attackers use in web requests in an effort to bypass detection.\n  At least one required.\n  See [Text Transformation](#text-transformation) below for details."
        },
        "field_to_match!": {
            "all_query_arguments": "(Optional) Inspect all query arguments.",
            "body": "(Optional) Inspect the request body, which immediately follows the request headers.",
            "cookies": "(Optional) Inspect the cookies in the web request. See [Cookies](#cookies) below for details.",
            "headers": "(Optional) Inspect the request headers. See [Headers](#headers) below for details.",
            "json_body": "(Optional) Inspect the request body as JSON. See [JSON Body](#json-body) for details.",
            "method": "(Optional) Inspect the HTTP method. The method indicates the type of operation that the request is asking the origin to perform.",
            "query_string": "(Optional) Inspect the query string. This is the part of a URL that appears after a `?` character, if any.",
            "single_header": "(Optional) Inspect a single header. See [Single Header](#single-header) below for details.",
            "single_query_argument": "(Optional) Inspect a single query argument. See [Single Query Argument](#single-query-argument) below for details.",
            "uri_path": "(Optional) Inspect the request URI path. This is the part of a web request that identifies a resource, for example, `/images/daily-ad.jpg`."
        },
        "positional_constraint!": "(Required) The area within the portion of a web request that you want AWS WAF to search for `search_string`. Valid values include the following: `EXACTLY`, `STARTS_WITH`, `ENDS_WITH`, `CONTAINS`, `CONTAINS_WORD`. See the AWS [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_ByteMatchStatement.html) for more information.",
        "search_string!": "(Required) A string value that you want AWS WAF to search for. AWS WAF searches only in the part of web requests that you designate for inspection in `field_to_match`. The maximum length of the value is 50 bytes.",
        "text_transformation!": {
            "priority!": "(Required) The relative processing order for multiple transformations that are defined for a rule statement. AWS WAF processes all transformations, from lowest priority to highest, before inspecting the transformed content.",
            "type!": "(Required) The transformation to apply, please refer to the Text Transformation [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_TextTransformation.html) for more details."
        },
        "country_codes!": "(Required) An array of two-character country codes, for example, [ \"US\", \"CN\" ], from the alpha-2 country ISO codes of the `ISO 3166` international standard. See the [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_GeoMatchStatement.html) for valid values.",
        "forwarded_ip_config": {
            "fallback_behavior!": "- (Required) The match status to assign to the web request if the request doesn't have a valid IP address in the specified position. Valid values include: `MATCH` or `NO_MATCH`.",
            "header_name!": "- (Required) The name of the HTTP header to use for the IP address."
        },
        "scope!": "(Required) Specify whether you want to match using the label name or just the namespace. Valid values are `LABEL` or `NAMESPACE`.",
        "arn!": "(Required) The Amazon Resource Name (ARN) of the Regex Pattern Set that this statement references.",
        "ip_set_forwarded_ip_config": "(Optional) The configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. See [IPSet Forwarded IP Config](#ipset-forwarded-ip-config) below for more details.\n\n### NOT Statement\n\nA logical rule statement used to negate the results of another rule statement. You provide one `statement` within the `not_statement`.\n\nThe `not_statement` block supports the following arguments:\n",
        "aggregate_key_type": "(Optional) Setting that indicates how to aggregate the request counts. Valid values include: `CONSTANT`, `CUSTOM_KEYS`, `FORWARDED_IP` or `IP`. Default: `IP`.",
        "custom_key": "(Optional) Aggregate the request counts using one or more web request components as the aggregate keys. See [`custom_key`](#custom_key-block) below for details.",
        "limit!": "(Required) The limit on requests per 5-minute period for a single originating IP address.",
        "scope_down_statement": "(Optional) An optional nested statement that narrows the scope of the rate-based statement to matching web requests. This can be any nestable statement, and you can nest statements at any level below this scope-down statement. See [Statement](#statement) above for details. If `aggregate_key_type` is set to `CONSTANT`, this block is required.\n\n### Regex Match Statement\n\nA rule statement used to search web request components for a match against a single regular expression.\n\nThe `regex_match_statement` block supports the following arguments:\n",
        "regex_string!": "(Required) The string representing the regular expression. Minimum of `1` and maximum of `512` characters.",
        "comparison_operator!": "(Required) The operator to use to compare the request part to the size setting. Valid values include: `EQ`, `NE`, `LE`, `LT`, `GE`, or `GT`.",
        "field_to_match": {
            "all_query_arguments": "(Optional) Inspect all query arguments.",
            "body": "(Optional) Inspect the request body, which immediately follows the request headers.",
            "cookies": "(Optional) Inspect the cookies in the web request. See [Cookies](#cookies) below for details.",
            "headers": "(Optional) Inspect the request headers. See [Headers](#headers) below for details.",
            "json_body": "(Optional) Inspect the request body as JSON. See [JSON Body](#json-body) for details.",
            "method": "(Optional) Inspect the HTTP method. The method indicates the type of operation that the request is asking the origin to perform.",
            "query_string": "(Optional) Inspect the query string. This is the part of a URL that appears after a `?` character, if any.",
            "single_header": "(Optional) Inspect a single header. See [Single Header](#single-header) below for details.",
            "single_query_argument": "(Optional) Inspect a single query argument. See [Single Query Argument](#single-query-argument) below for details.",
            "uri_path": "(Optional) Inspect the request URI path. This is the part of a web request that identifies a resource, for example, `/images/daily-ad.jpg`."
        },
        "size!": "(Required) The size, in bytes, to compare to the request part, after any transformations. Valid values are integers between 0 and 21474836480, inclusive.",
        "all_query_arguments": "(Optional) Inspect all query arguments.",
        "body": "(Optional) Inspect the request body, which immediately follows the request headers.",
        "cookies": {
            "match_pattern!": "(Required) The filter to use to identify the subset of cookies to inspect in a web request. You must specify exactly one setting: either `all`, `included_cookies` or `excluded_cookies`. More details: [CookieMatchPattern](https://docs.aws.amazon.com/waf/latest/APIReference/API_CookieMatchPattern.html)",
            "match_scope!": "(Required) The parts of the cookies to inspect with the rule inspection criteria. If you specify All, AWS WAF inspects both keys and values. Valid values: `ALL`, `KEY`, `VALUE`",
            "oversize_handling!": "(Required) What AWS WAF should do if the cookies of the request are larger than AWS WAF can inspect. AWS WAF does not support inspecting the entire contents of request cookies when they exceed 8 KB (8192 bytes) or 200 total cookies. The underlying host service forwards a maximum of 200 cookies and at most 8 KB of cookie contents to AWS WAF. Valid values: `CONTINUE`, `MATCH`, `NO_MATCH`"
        },
        "headers": {
            "match_pattern!": "(Required) The filter to use to identify the subset of headers to inspect in a web request. The `match_pattern` block supports only one of the following arguments:\n    ",
            "all": "An empty configuration block that is used for inspecting all headers.\n    ",
            "included_headers": "An array of strings that will be used for inspecting headers that have a key that matches one of the provided values.\n    ",
            "excluded_headers": "An array of strings that will be used for inspecting headers that do not have a key that matches one of the provided values.",
            "match_scope!": "(Required) The parts of the headers to inspect with the rule inspection criteria. If you specify `All`, AWS WAF inspects both keys and values. Valid values include the following: `ALL`, `Key`, `Value`.",
            "oversize_handling!": "(Required) Oversize handling tells AWS WAF what to do with a web request when the request component that the rule inspects is over the limits. Valid values include the following: `CONTINUE`, `MATCH`, `NO_MATCH`. See the AWS [documentation](https://docs.aws.amazon.com/waf/latest/developerguide/waf-rule-statement-oversize-handling.html) for more information."
        },
        "json_body": {
            "invalid_fallback_behavior": "(Optional) What to do when JSON parsing fails. Defaults to evaluating up to the first parsing failure. Valid values are `EVALUATE_AS_STRING`, `MATCH` and `NO_MATCH`.",
            "match_pattern!": "(Required) The patterns to look for in the JSON body. You must specify exactly one setting: either `all` or `included_paths`. See [JsonMatchPattern](https://docs.aws.amazon.com/waf/latest/APIReference/API_JsonMatchPattern.html) for details.",
            "match_scope!": "(Required) The parts of the JSON to match against using the `match_pattern`. Valid values are `ALL`, `KEY` and `VALUE`.",
            "oversize_handling": "(Optional) What to do if the body is larger than can be inspected. Valid values are `CONTINUE` (default), `MATCH` and `NO_MATCH`."
        },
        "method": "(Optional) Inspect the HTTP method. The method indicates the type of operation that the request is asking the origin to perform.",
        "query_string": "(Optional) Inspect the query string. This is the part of a URL that appears after a `?` character, if any.",
        "single_header": {
            "name": "(Optional) The name of the query header to inspect. This setting must be provided as lower case characters."
        },
        "single_query_argument": {
            "name": "(Optional) The name of the query header to inspect. This setting must be provided as lower case characters."
        },
        "uri_path": "(Optional) Inspect the request URI path. This is the part of a web request that identifies a resource, for example, `/images/daily-ad.jpg`.\n\n### Forwarded IP Config\n\nThe configuration for inspecting IP addresses in an HTTP header that you specify, instead of using the IP address that's reported by the web request origin. Commonly, this is the X-Forwarded-For (XFF) header, but you can specify\nany header name. If the specified header isn't present in the request, AWS WAFv2 doesn't apply the rule to the web request at all.\nAWS WAFv2 only evaluates the first IP address found in the specified HTTP header.\n\nThe `forwarded_ip_config` block supports the following arguments:\n",
        "fallback_behavior!": "(Required) - The match status to assign to the web request if the request doesn't have a valid IP address in the specified position. Valid values include: `MATCH` or `NO_MATCH`.",
        "header_name!": "(Required) - The name of the HTTP header to use for the IP address.",
        "position!": "(Required) - The position in the header to search for the IP address. Valid values include: `FIRST`, `LAST`, or `ANY`. If `ANY` is specified and the header contains more than 10 IP addresses, AWS WAFv2 inspects the last 10.\n\n### Headers\n\nInspect the request headers.\n\nThe `headers` block supports the following arguments:\n",
        "match_pattern!": "(Required) The filter to use to identify the subset of cookies to inspect in a web request. You must specify exactly one setting: either `all`, `included_cookies` or `excluded_cookies`. More details: [CookieMatchPattern](https://docs.aws.amazon.com/waf/latest/APIReference/API_CookieMatchPattern.html)",
        "all": "An empty configuration block that is used for inspecting all headers.\n    ",
        "included_headers": "An array of strings that will be used for inspecting headers that have a key that matches one of the provided values.\n    ",
        "excluded_headers": "An array of strings that will be used for inspecting headers that do not have a key that matches one of the provided values.",
        "match_scope!": "(Required) The parts of the cookies to inspect with the rule inspection criteria. If you specify All, AWS WAF inspects both keys and values. Valid values: `ALL`, `KEY`, `VALUE`",
        "oversize_handling!": "(Required) What AWS WAF should do if the cookies of the request are larger than AWS WAF can inspect. AWS WAF does not support inspecting the entire contents of request cookies when they exceed 8 KB (8192 bytes) or 200 total cookies. The underlying host service forwards a maximum of 200 cookies and at most 8 KB of cookie contents to AWS WAF. Valid values: `CONTINUE`, `MATCH`, `NO_MATCH`\n\n### Text Transformation\n\nThe `text_transformation` block supports the following arguments:\n",
        "invalid_fallback_behavior": "(Optional) What to do when JSON parsing fails. Defaults to evaluating up to the first parsing failure. Valid values are `EVALUATE_AS_STRING`, `MATCH` and `NO_MATCH`.",
        "oversize_handling": "(Optional) What to do if the body is larger than can be inspected. Valid values are `CONTINUE` (default), `MATCH` and `NO_MATCH`.\n\n### Single Header\n\nInspect a single header. Provide the name of the header to inspect, for example, `User-Agent` or `Referer` (provided as lowercase strings).\n\nThe `single_header` block supports the following arguments:\n",
        "type!": "(Required) The transformation to apply, please refer to the Text Transformation [documentation](https://docs.aws.amazon.com/waf/latest/APIReference/API_TextTransformation.html) for more details.\n\n### Visibility Configuration\n\nThe `visibility_config` block supports the following arguments:\n",
        "cloudwatch_metrics_enabled!": "(Required) A boolean indicating whether the associated resource sends metrics to CloudWatch. For the list of available metrics, see [AWS WAF Metrics](https://docs.aws.amazon.com/waf/latest/developerguide/monitoring-cloudwatch.html#waf-metrics).",
        "metric_name": "(Required, Forces new resource) A friendly name of the CloudWatch metric. The name can contain only alphanumeric characters (A-Z, a-z, 0-9) hyphen(-) and underscore (_), with length from one to 128 characters. It can't contain whitespace or metric names reserved for AWS WAF, for example `All` and `Default_Action`.",
        "sampled_requests_enabled!": "(Required) A boolean indicating whether AWS WAF should store a sampling of the web requests that match the rules. You can view the sampled requests through the AWS WAF console.\n\n### Captcha Configuration\n\nThe `captcha_config` block supports the following arguments:\n",
        "immunity_time_property": {
            "immunity_time": "(Optional) The amount of time, in seconds, that a CAPTCHA or challenge timestamp is considered valid by AWS WAF. The default setting is 300."
        },
        "immunity_time": "(Optional) The amount of time, in seconds, that a CAPTCHA or challenge timestamp is considered valid by AWS WAF. The default setting is 300."
    },
    "Attribute Reference": {
        "id": "The ID of the WAF rule group.",
        "arn": "The ARN of the WAF rule group.",
        "tags_all": "A map of tags assigned to the resource, including those inherited from the provider [`default_tags` configuration block](https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block).\n\n### `custom_key` Block\n\nAggregate the request counts using one or more web request components as the aggregate keys. With this option, you must specify the aggregate keys in the `custom_keys` block. To aggregate on only the IP address or only the forwarded IP address, don't use custom keys. Instead, set the `aggregate_key_type` to `IP` or `FORWARDED_IP`.\n\nThe `custom_key` block supports the following arguments:\n",
        "cookie": "(Optional) Use the value of a cookie in the request as an aggregate key. See [RateLimit `cookie`](#ratelimit-cookie-block) below for details.",
        "forwarded_ip": "(Optional) Use the first IP address in an HTTP header as an aggregate key. See [`forwarded_ip`](#ratelimit-forwarded_ip-block) below for details.",
        "http_method": "(Optional) Use the request's HTTP method as an aggregate key. See [RateLimit `http_method`](#ratelimit-http_method-block) below for details.",
        "header": "(Optional) Use the value of a header in the request as an aggregate key. See [RateLimit `header`](#ratelimit-header-block) below for details.",
        "ip": "(Optional) Use the request's originating IP address as an aggregate key. See [`RateLimit ip`](#ratelimit-ip-block) below for details.",
        "label_namespace": "(Optional) Use the specified label namespace as an aggregate key. See [RateLimit `label_namespace`](#ratelimit-label_namespace-block) below for details.",
        "query_argument": "(Optional) Use the specified query argument as an aggregate key. See [RateLimit `query_argument`](#ratelimit-query_argument-block) below for details.",
        "query_string": "(Optional) Use the request's query string as an aggregate key. See [RateLimit `query_string`](#ratelimit-query_string-block) below for details.",
        "uri_path": "(Optional) Use the request's URI path as an aggregate key. See [RateLimit `uri_path`](#ratelimit-uri_path-block) below for details.\n\n### RateLimit `cookie` Block\n\nUse the value of a cookie in the request as an aggregate key. Each distinct value in the cookie contributes to the aggregation instance. If you use a single cookie as your custom key, then each value fully defines an aggregation instance.\n\nThe `cookie` block supports the following arguments:\n"
    },
    "Import": {
        "In Terraform v1.5.0 and later, use an [`import` block](https://developer.hashicorp.com/terraform/language/import) to import WAFv2 Rule Group using `ID/name/scope`. For example:": {
            "```terraform": "\n\n\nimport {\n  to = aws_wafv2_rule_group.example\n  id = \"a1b2c3d4-d5f6-7777-8888-9999aaaabbbbcccc/example/REGIONAL\"\n}\n```\n\nUsing `terraform import`, import WAFv2 Rule Group using `ID/name/scope`. For example:\n\n```console\n% terraform import aws_wafv2_rule_group.example a1b2c3d4-d5f6-7777-8888-9999aaaabbbbcccc/example/REGIONAL\n```\n"
        }
    }
}
